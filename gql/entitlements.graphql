extend type Mutation {
    """
    Creates the entitlement. Site-admin only.
    """
    createEntitlement(
        """
        The name of the entitlement.
        """
        name: String!

        """
        The type of the entitlement.
        """
        type: EntitlementType!

        """
        The limit value for this entitlement.
        """
        limit: BigInt!

        """
        The window to enforce this entitlement over.
        """
        window: EntitlementWindow!

        """
        Whether this is the default entitlement for its type.
        """
        isDefault: Boolean = false
    ): Entitlement!

    """
    Updates the entitlement. Site-admin only.
    """
    updateEntitlement(
        """
        The ID of the entitlement to update.
        """
        id: ID!

        """
        The name of the entitlement.
        """
        name: String!

        """
        The limit value for this entitlement.
        """
        limit: BigInt!

        """
        The window to enforce this entitlement over.
        """
        window: EntitlementWindow!

        """
        Whether this is the default entitlement for its type.
        """
        isDefault: Boolean = false
    ): Entitlement!

    """
    Deletes the entitlement. Site-admin only.
    """
    deleteEntitlement(id: ID!): EmptyResponse!

    """
    Grants the entitlement to the users. Site-admin only.
    """
    createEntitlementGrants(
        """
        The ID of the entitlement to grant.
        """
        entitlementID: ID!
        """
        The list of users IDs to grant the entitlement to.
        """
        userIDs: [ID!]!
    ): CreateEntitlementGrantsResult!

    """
    Deletes the entitlement grants. Site-admin only.
    """
    deleteEntitlementGrants(
        """
        The ID of the entitlement grant to delete.
        """
        entitlementID: ID!
        """
        The list of users IDs to delete the grant from.
        """
        userIDs: [ID!]!
    ): EmptyResponse!
}

extend type Query {
    """
    Returns an entitlement by its ID.
    """
    entitlement(id: ID!): Entitlement

    """
    Returns all entitlements in a paginated format.
    """
    entitlements(
        """
        The type of the entitlement.
        """
        type: EntitlementType
        """
        Whether this is the default entitlement for its type.
        """
        isDefault: Boolean
        """
        The limit argument for forward pagination.
        """
        first: Int
        """
        The limit argument for backward pagination.
        """
        last: Int
        """
        The cursor argument for forward pagination.
        """
        after: String
        """
        The cursor argument for backward pagination.
        """
        before: String
    ): EntitlementConnection!
}

extend type User {
    """
    Entitlement for the user. This includes default entitlements for types
    where the user has no explicit grant (marked with isDefault: true).
    """
    entitlements(
        """
        The ID of the entitlement.
        """
        entitlementID: ID
        """
        The type of entitlement to filter by.
        """
        type: EntitlementType
    ): [UserEntitlement!]!
}

"""
Entitlement defines configurable limits for LLM credit consumption by users
or other principals. It allows site admins to control and distribute LLM spend
by setting quotas with specific time windows.
"""
type Entitlement {
    """
    The ID of the entitlement.
    """
    id: ID!

    """
    The name of the entitlement.
    """
    name: String!

    """
    The type of the entitlement.
    """
    type: EntitlementType!

    """
    The limit value for this entitlement.
    """
    limit: BigInt!

    """
    The frequency at which this entitlement is renewed.
    """
    window: EntitlementWindow!

    """
    Whether this is the default entitlement for its type.
    """
    isDefault: Boolean!

    """
    When this entitlement was last updated.
    """
    updatedAt: DateTime!

    """
    Users who have this entitlement. For default entitlements, this includes
    all users without an explicit grant of this entitlement type.
    """
    userGrants(
        """
        The limit argument for forward pagination.
        """
        first: Int
        """
        The limit argument for backward pagination.
        """
        last: Int
        """
        The cursor argument for forward pagination.
        """
        after: String
        """
        The cursor argument for backward pagination.
        """
        before: String
        """
        Field to order results by.
        """
        orderBy: EntitlementUserGrantsOrderBy = USERNAME
        """
        If true, sort in descending order.
        """
        descending: Boolean = false
    ): UserConnection!
}

"""
A list of entitlements.
"""
type EntitlementConnection {
    """
    A list of entitlements.
    """
    nodes: [Entitlement!]!
    """
    The total count of entitlements in the connection. This total count may be larger
    than the number of nodes in this object when the result is paginated.
    """
    totalCount: Int!
    """
    Pagination information.
    """
    pageInfo: ConnectionPageInfo!
}

"""
UserEntitlement maps a user to an entitlement.
"""
type UserEntitlement {
    """
    The ID of the entitlement.
    """
    entitlementID: ID!
    """
    The entitlement that was granted.
    """
    entitlement: Entitlement!
    """
    The ID of the user.
    """
    userID: ID!
    """
    Whether this is a default entitlement (true when the user has no explicit grant for this type).
    """
    isDefault: Boolean!
    """
    Usage information for this entitlement grant. Returns null if usage tracking is not
    supported for this entitlement type.
    """
    usage: EntitlementGrantUsage
}

"""
EntitlementGrantUsage represents the current usage state for an entitlement grant.
"""
type EntitlementGrantUsage {
    """
    The limit value for this entitlement.
    """
    limit: BigInt!
    """
    The amount consumed in the current window.
    """
    consumed: BigInt!
    """
    When the current window started.
    """
    windowStart: DateTime
    """
    When the current window resets.
    """
    windowReset: DateTime
}

"""
EntitlementWindow represents the available time periods for entitlement enforcement.
"""
enum EntitlementWindow {
    ONE_DAY
    SEVEN_DAYS
}

"""
EntitlementType represents the available types of entitlements.
"""
enum EntitlementType {
    DEEP_SEARCH
}

"""
EntitlementUserGrantsOrderBy enumerates the ways a user grants list can be ordered.
"""
enum EntitlementUserGrantsOrderBy {
    USERNAME
    USAGE
}

"""
Result of a createEntitlementGrants operation.
"""
type CreateEntitlementGrantsResult {
    """
    Users that were not granted the entitlement because they already have
    an entitlement of this type.
    """
    skippedUsers: [User!]!
}
